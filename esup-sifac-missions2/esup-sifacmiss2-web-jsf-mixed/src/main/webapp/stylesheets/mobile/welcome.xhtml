<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:tr="http://myfaces.apache.org/trinidad"
	template="template.xhtml">
	
	<ui:define name="toolbar">
		<h1 class="full">
			<h:outputText value="#{msgs['M_BLANK.TEXT']}" />
		</h1>
	</ui:define>

	<ui:define name="content">
		<h:form>
			<ul class="rounded">
				<li class="arrow">
					<h:selectOneMenu value="#{welcomeController.year}" onchange="changeYear()">
						<f:selectItems value="#{welcomeController.yearItems}" />
					</h:selectOneMenu>
				</li>
			</ul>
			<div style="display:none" id="changeYearBtn">
				<h:commandButton action="#{welcomeController.changeYear}" />
			</div>
		</h:form>
		<f:subview rendered="#{empty welcomeController.missions}">
			<div class="info">
				<h:outputText value="#{msgs['WELCOME.MISSION.EMPTY_YEAR']} #{welcomeController.year}" />
			</div>
		</f:subview>
		<f:subview rendered="#{not empty welcomeController.missions}">
			<h:form>
				<ul class="scroll metal missions">
					<tr:iterator var="mission" value="#{welcomeController.missions}" rows="0">
						<li class="arrow">
							<h:commandLink action="mission">
								<f:setPropertyActionListener value="mission" target="#{sessionController.action}" />
								<f:setPropertyActionListener value="#{mission}" target="#{welcomeController.currentMission}" />
								<strong>
									<h:outputText value="#{mission.motif}" />
								</strong>
								<em>
									<h:outputText value="#{msgs['WELCOME.MISSION.M_START']} &#160;" />
									<h:outputText value="#{mission.periode.debut}">
										<tr:convertDateTime locale="fr" type="date" />
									</h:outputText>
									<br />
									<h:outputText value="#{msgs['WELCOME.MISSION.M_END']} &#160;" />
									<h:outputText value="#{mission.periode.fin}">
										<tr:convertDateTime locale="fr" type="date" />
									</h:outputText>
								</em>
								<small>
									<h:outputText value="#{mission.montant}">
										<tr:convertNumber locale="fr" type="currency" currencySymbol="&#8364;" />
									</h:outputText>
								</small>
							</h:commandLink>
						</li>
					</tr:iterator>
				</ul>
			</h:form>
		</f:subview>
		<script type="text/javascript">
			function changeYear() {
				document.getElementById('changeYearBtn').getElementsByTagName("input").item(0).click();
			}
		</script>
	</ui:define>

</ui:composition>